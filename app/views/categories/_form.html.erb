<%= form_for(@category) do |f| %>
    <% if @category.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@category.errors.count, "error") %> prohibited this category from being saved:</h2>

          <ul>
            <% @category.errors.full_messages.each do |message| %>
                <li><%= message %></li>
            <% end %>
          </ul>
        </div>
    <% end %>


    <div class="field">
      <%= f.label :name %>
      <br>
      <%= f.text_field :name, class: "form-control" %>
      <br>
      <%= f.label :parent_id %>
      <br>
      <%=
          f.collection_select :parent_id, @categories, :id, :name, {selected: @category.parent_id, :include_blank => true}, class: "form-control" %>
      <br>
      <%= f.label :selected_questions %>
      <%= f.collection_select :questions, @category.questions, :id, :question, {}, { multiple: true, class: "form-control"  }%>
      Doubleclick to show questions
      <br>
      <div align="center">
         <button id="btn_select" class="btn btn-success">Select</button>
         <button id="btn_deselect" class="btn btn-warning">Deselect</button>
         <%= link_to 'New Question', new_question_path(:category_id=>@category.id), class: 'btn btn-primary' %>
      </div>
      <br>
      <%= f.label :other_questions %>
      <select class="form-control" id="unused_questions" multiple="multiple">
      <optgroup value="category" label="Questions without Category"/>
      <% Question.all.each do |quest|
            if quest.categories.empty? %>
              <option value="<%= quest.id %>"><%= quest.question  %></option>
            <% end
         end
         Category.all.each do |cat| %>
           <% if !cat.questions.empty? && cat.id != @category.id %>
             <optgroup value="category" label="Questions of Category: <%= cat.name %>"/>
             <% cat.questions.all.each do |quest| %>
                <option value="<%= quest.id %>"><%= quest.question  %></option>
             <%
                end
           end
          end
       %>
       </select>
      Doubleclick to show questions
    </div>

    <div class="actions">
      <%= f.submit :Save, {class: "btn btn-primary align-right", id: "btn_submit" } %>
    </div>
<% end %>
